<h2 class="mt-4">Grup KontenjanÄ±</h2>

<%= form_with url: update_group_quota_admin_setting_path, method: :patch, scope: :system_setting do |form| %>
  <div class="mb-3">
    <%= form.label :value, "Grup KontenjanÄ± (KiÅŸi SayÄ±sÄ±)" %>
    <%= form.number_field :value, value: @group_quota.value || 3, min: 1, class: "form-control" %>
  </div>
  <%= form.submit "KontenjanÄ± GÃ¼ncelle", class: "btn btn-success" %>
<% end %>

<h1>Grup OluÅŸturma Son Tarihi AyarÄ±</h1>

  
  <%= form_with url: admin_setting_path, method: :patch, scope: :system_setting, local: true do |form| %>
    <%= form.label :value, "Grup OluÅŸturma Son Tarihi" %>
    <%= form.date_field :value, value: @deadline.value %>

    <%= form.submit "GÃ¼ncelle", class: "btn btn-primary" %>
<% end %>


<h2 class="mt-5">Grup OluÅŸturmamÄ±ÅŸ Ã–ÄŸrenciler</h2>

<% if @deadline.present? %>
  <p><strong>Son tarih:</strong> <%= @deadline.value.to_date.strftime("%d.%m.%Y") %></p>

  <% if @students_without_group.any? %>
    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th>Ad Soyad</th>
          <th>Ã–ÄŸrenci NumarasÄ±</th>
          <th>KayÄ±t Tarihi</th>
        </tr>
      </thead>
      <tbody>
        <% @students_without_group.each do |student| %>
          <tr>
            <td><%= student.full_name %></td>
            <td><%= student.student_number %></td>
            <td><%= student.created_at.strftime("%d.%m.%Y") %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <div class="alert alert-success">TÃ¼m Ã¶ÄŸrenciler gruba katÄ±lmÄ±ÅŸ gÃ¶rÃ¼nÃ¼yor âœ…</div>
  <% end %>
<% else %>
  <div class="alert alert-warning">HenÃ¼z bir son tarih belirlenmemiÅŸ. Listeleme iÃ§in lÃ¼tfen bir tarih girin.</div>
<% end %>

<%= link_to "ğŸ“„ CSV DÄ±ÅŸa Aktar", export_unassigned_students_admin_setting_path(format: :csv), class: "btn btn-outline-primary mb-3" %>

<%= button_to "ğŸ“§ E-Posta GÃ¶nder", email_unassigned_students_admin_setting_path, method: :post, class: "btn btn-outline-danger mb-3", data: { confirm: "TÃ¼m Ã¶ÄŸrencilere e-posta gÃ¶nderilecek. Emin misiniz?" } %>

<h2 class="mt-4">Mevcut Gruplar</h2>

<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th>Grup AdÄ±</th>
      <th>Grup Ãœyeleri</th>
    </tr>
  </thead>
  <tbody>
    <% @groups.each do |group| %>
      <tr>
        <td><%= group.name %></td>
        <td>
          <ul class="mb-0 ps-3">
            <% group.students.each do |student| %>
              <li><%= student.full_name %> - <%= student.student_number %></li>
            <% end %>
          </ul>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>


<%= button_to "ğŸ‘¥ Rastgele Grup OluÅŸtur", random_group_students_admin_setting_path, method: :post, class: "btn btn-success mb-3", data: { confirm: "TÃ¼m grup oluÅŸturmamÄ±ÅŸ Ã¶ÄŸrenciler rastgele gruplandÄ±rÄ±lacak. Devam edilsin mi?" } %>